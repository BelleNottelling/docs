# Расширение / Контейнеры

Flight разработан для того, чтобы быть расширяемым фреймворком. Фреймворк поставляется с набором
стандартных методов и компонентов, но позволяет вам сопоставлять свои собственные методы,
регистрировать собственные классы или даже переопределять существующие классы и методы.

## Сопоставление Методов

Для сопоставления вашего собственного метода используйте функцию `map`:

```php
// Сопоставление вашего метода
Flight::map('hello', function (string $name) {
  echo "привет $name!";
});

// Вызов вашего собственного метода
Flight::hello('Боб');
```

## Регистрация Классов / Контейнеризация

Для регистрации своего собственного класса используйте функцию `register`:

```php
// Регистрация вашего класса
Flight::register('user', User::class);

// Получение экземпляра вашего класса
$user = Flight::user();
```

Метод register также позволяет передавать параметры в конструктор вашего класса.
Таким образом, при загрузке вашего собственного класса он будет предварительно инициализирован.
Вы можете определить параметры конструктора, передавая дополнительный массив.
Вот пример загрузки соединения с базой данных:

```php
// Регистрация класса с параметрами конструктора
Flight::register('db', PDO::class, ['mysql:host=localhost;dbname=test', 'user', 'pass']);

// Получение экземпляра вашего класса
// Это создаст объект с заданными параметрами
//
// new PDO('mysql:host=localhost;dbname=test','user','pass');
//
$db = Flight::db();
```

Если передать дополнительный параметр обратного вызова, он будет выполнен немедленно
после построения объекта класса. Это позволяет вам выполнить любые процедуры настройки для вашего
нового объекта. Функция обратного вызова принимает один параметр - экземпляр нового объекта.

```php
// Обратный вызов будет передан сконструированному объекту
Flight::register(
  'db',
  PDO::class,
  ['mysql:host=localhost;dbname=test', 'user', 'pass'],
  function (PDO $db) {
    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
  }
);
```

По умолчанию, каждый раз при загрузке класса вы получите общий экземпляр.
Чтобы получить новый экземпляр класса, просто передайте `false` в качестве параметра:

```php
// Общий экземпляр класса
$shared = Flight::db();

// Новый экземпляр класса
$new = Flight::db(false);
```

Имейте в виду, что для сопоставленных методов имеет первенство над зарегистрированными классами. Если вы
объявите оба, используя одно и то же имя, будет вызван только сопоставленный метод.
